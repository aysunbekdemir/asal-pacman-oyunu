<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asal Pac-Man - Eratosthenes Kalburu Oyunu</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 900px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #5a67d8;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .info-panel {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .info-box {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.1em;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 5px;
            margin: 20px auto;
            max-width: 600px;
            background: #2c3e50;
            padding: 15px;
            border-radius: 15px;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            background: #34495e;
            color: white;
            border: 2px solid #2c3e50;
        }

        .cell.prime {
            background: #34495e;
            /* Asal sayÄ±lar da normal gÃ¶rÃ¼necek */
            color: white;
        }

        .cell.composite {
            background: #34495e;
            /* BileÅŸik sayÄ±lar da normal gÃ¶rÃ¼necek */
            color: white;
        }

        .cell.revealed-prime {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            animation: glow 2s ease-in-out infinite;
            color: white;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .cell.revealed-composite {
            background: linear-gradient(135deg, #fc466b 0%, #3f5efb 100%);
            color: #fff;
        }

        .cell.eaten {
            background: #95a5a6 !important;
            opacity: 0.3;
            transform: scale(0.8);
            color: #7f8c8d;
        }

        /* Kalbur modu renkleri */
        .cell.sieve-yellow {
            background: #f1c40f !important;
            color: #333;
            border: 2px solid #f39c12;
        }

        .cell.sieve-blue {
            background: #3498db !important;
            color: white;
            border: 2px solid #2980b9;
        }

        .cell.sieve-purple {
            background: #9b59b6 !important;
            color: white;
            border: 2px solid #8e44ad;
        }

        .cell.sieve-red {
            background: #e74c3c !important;
            color: white;
            border: 2px solid #c0392b;
        }

        .cell.sieve-prime {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%) !important;
            animation: glow 2s ease-in-out infinite;
            color: white;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            border: 2px solid #27ae60;
        }

        .cell.sieve-eliminated {
            background: #7f8c8d !important;
            opacity: 0.5;
            text-decoration: line-through;
            color: #34495e;
        }

        .cell.pacman {
            background: #f1c40f !important;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            animation: chomp 0.5s infinite;
            font-size: 1.5em;
        }

        .cell.ghost {
            background: #e74c3c !important;
            animation: float 2s ease-in-out infinite;
            font-size: 1.3em;
        }

        @keyframes glow {

            0%,
            100% {
                box-shadow: 0 0 20px rgba(56, 239, 125, 0.7);
            }

            50% {
                box-shadow: 0 0 30px rgba(56, 239, 125, 0.9);
            }
        }

        @keyframes chomp {

            0%,
            100% {
                transform: rotate(0deg);
            }

            50% {
                transform: rotate(10deg);
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        .controls {
            text-align: center;
            margin-top: 20px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .message {
            text-align: center;
            font-size: 1.3em;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .message.success {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            color: #0c5460;
        }

        .message.error {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #721c24;
        }

        .message.info {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #004085;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
        }

        .legend-color {
            width: 30px;
            height: 30px;
            border-radius: 5px;
        }

        .instructions {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.1em;
            line-height: 1.6;
        }

        @media (max-width: 600px) {
            .game-board {
                gap: 3px;
                padding: 10px;
            }

            .cell {
                font-size: 0.9em;
            }

            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>

<body>
    <div class="game-container">
        <h1>ğŸ® Asal Pac-Man ğŸ®</h1>

        <div class="instructions">
            <p>ğŸ‘¾ Merhaba! Ben Pac-Man ve sadece ASAL SAYILARI yiyorum!</p>
            <p>ğŸ¯ Hedef: Hangi sayÄ±larÄ±n asal olduÄŸunu tahmin et ve topla!</p>
            <p>ğŸ® Oyun: SayÄ±lara tÄ±klayarak Pac-Man'i hareket ettir</p>
            <p>ğŸ’¡ Ä°pucu: Eratosthenes Kalburu yÃ¶ntemini kullan! YediÄŸin sayÄ±lar asal mÄ± deÄŸil mi gÃ¶sterilecek!</p>
            <p>âš ï¸ Dikkat: BaÅŸlangÄ±Ã§ta hangi sayÄ±larÄ±n asal olduÄŸu belli deÄŸil - kendin bulmalÄ±sÄ±n!</p>
        </div>

        <div class="info-panel">
            <div class="info-box">ğŸ“Š Puan: <span id="score">0</span></div>
            <div class="info-box">ğŸ¯ Kalan Asal: <span id="remaining">0</span></div>
            <div class="info-box">ğŸ® Seviye: <span id="level">1</span></div>
            <div class="info-box">â¤ï¸ Can: <span id="lives">3</span></div>
            <div class="info-box">ğŸ’¡ Ä°pucu: <span id="hints">0</span></div>
        </div>

        <div id="message" class="message info">Oyunu baÅŸlatmak iÃ§in 'Yeni Oyun' butonuna bas!</div>

        <div class="game-board" id="gameBoard"></div>

        <div class="controls">
            <button onclick="startGame()">ğŸ® Yeni Oyun</button>
            <button onclick="showHint()">ğŸ’¡ Ä°pucu GÃ¶ster</button>
            <button onclick="toggleSieveMode()">ğŸ”¢ Kalbur Modu: <span id="sieveStatus">KAPALI</span></button>
            <button onclick="showSieveInstructions()">ğŸ“š Kalbur NasÄ±l KullanÄ±lÄ±r?</button>
            <button onclick="toggleShuffle()">ğŸ² KarÄ±ÅŸÄ±k Mod: <span id="shuffleStatus">KAPALI</span></button>
            <button onclick="toggleGhosts()">ğŸ‘» Hayaletler: <span id="ghostStatus">KAPALI</span></button>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #34495e;"></div>
                <span>Bilinmeyen SayÄ±</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);"></div>
                <span>Asal (Yendikten Sonra)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #fc466b 0%, #3f5efb 100%);"></div>
                <span>BileÅŸik (Yendikten Sonra)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f1c40f;"></div>
                <span>Pac-Man</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #e74c3c;"></div>
                <span>Hayalet</span>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            score: 0,
            level: 1,
            lives: 3,
            pacmanPos: null,
            ghostPos: null,
            ghostsEnabled: false,
            primes: [],
            eaten: [],
            maxNum: 100,
            gameActive: false,
            hintUsed: false,
            hintCount: 0,
            sieveMode: false,  // Kalbur modu aÃ§Ä±k mÄ±?
            sieveSteps: {},    // Hangi sayÄ±lar hangi renkte iÅŸaretlendi
            sieveMultiples: {  // Katlar iÃ§in renkler
                2: 'yellow',
                3: 'blue',
                5: 'purple',
                7: 'red'
            },
            shuffleMode: false, // KarÄ±ÅŸÄ±k mod
            numberOrder: []     // SayÄ±larÄ±n sÄ±rasÄ±
        };

        // Eratosthenes Kalburu algoritmasÄ±
        function sieveOfEratosthenes(max) {
            let isPrime = new Array(max + 1).fill(true);
            isPrime[0] = isPrime[1] = false;

            for (let i = 2; i * i <= max; i++) {
                if (isPrime[i]) {
                    for (let j = i * i; j <= max; j += i) {
                        isPrime[j] = false;
                    }
                }
            }

            let primes = [];
            for (let i = 2; i <= max; i++) {
                if (isPrime[i]) primes.push(i);
            }
            return primes;
        }

        // Kalbur modunda sayÄ±ya tÄ±klama
        function applySieve(num) {
            if (!gameState.sieveMode || !gameState.gameActive) return;

            // Hangi asal sayÄ±nÄ±n katlarÄ± iÅŸaretlenecek?
            let divisor = null;
            let color = null;

            // 2, 3, 5, 7'nin kendileri mi tÄ±klandÄ±?
            if (num === 2) {
                divisor = 2;
                color = 'yellow';
                showMessage('2\'nin katlarÄ±nÄ± eliyorum (sarÄ±)', 'info');
            } else if (num === 3) {
                divisor = 3;
                color = 'blue';
                showMessage('3\'Ã¼n katlarÄ±nÄ± eliyorum (mavi)', 'info');
            } else if (num === 5) {
                divisor = 5;
                color = 'purple';
                showMessage('5\'in katlarÄ±nÄ± eliyorum (mor)', 'info');
            } else if (num === 7) {
                divisor = 7;
                color = 'red';
                showMessage('7\'nin katlarÄ±nÄ± eliyorum (kÄ±rmÄ±zÄ±)', 'info');
            }

            // KatlarÄ± iÅŸaretle
            if (divisor) {
                for (let i = divisor * 2; i <= 100; i += divisor) {
                    if (!gameState.sieveSteps[i]) {
                        gameState.sieveSteps[i] = color;
                        gameState.score += 2; // Kalbur kullanÄ±mÄ± iÃ§in az puan
                    }
                }
                updateBoard();
            }
        }

        // Kalbur tamamlandÄ± mÄ± kontrol et
        function checkSieveComplete() {
            if (!gameState.sieveMode) return false;

            // TÃ¼m bileÅŸik sayÄ±lar iÅŸaretlendi mi?
            let allCompositeMarked = true;
            for (let i = 2; i <= 100; i++) {
                if (!gameState.primes.includes(i) && !gameState.sieveSteps[i]) {
                    allCompositeMarked = false;
                    break;
                }
            }

            if (allCompositeMarked) {
                // Asal sayÄ±larÄ± yeÅŸil yap
                gameState.primes.forEach(prime => {
                    if (!gameState.sieveSteps[prime]) {
                        gameState.sieveSteps[prime] = 'prime';
                    }
                });

                gameState.score += 50; // Kalbur tamamlama bonusu
                showMessage('ğŸ‰ Kalbur tamamlandÄ±! YeÅŸil sayÄ±lar asal! +50 puan', 'success');
                gameState.sieveMode = false; // Kalbur modunu kapat

                setTimeout(() => {
                    levelComplete();
                }, 2000);

                return true;
            }
            return false;
        }

        function initBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';

            // SayÄ±larÄ± hazÄ±rla
            gameState.numberOrder = [];
            for (let i = 1; i <= 100; i++) {
                gameState.numberOrder.push(i);
            }

            // KarÄ±ÅŸÄ±k modda sayÄ±larÄ± karÄ±ÅŸtÄ±r
            if (gameState.shuffleMode) {
                // Fisher-Yates shuffle algoritmasÄ±
                for (let i = gameState.numberOrder.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [gameState.numberOrder[i], gameState.numberOrder[j]] =
                        [gameState.numberOrder[j], gameState.numberOrder[i]];
                }
            }

            // TahtayÄ± oluÅŸtur
            gameState.numberOrder.forEach(num => {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.textContent = num;
                cell.dataset.number = num;
                cell.onclick = () => {
                    if (gameState.sieveMode) {
                        applySieve(num);
                    } else {
                        movePackman(num);
                    }
                };
                board.appendChild(cell);
            });

            updateBoard();
        }

        function updateBoard() {
            const cells = document.querySelectorAll('.cell');

            cells.forEach(cell => {
                const num = parseInt(cell.dataset.number);

                // SÄ±nÄ±flarÄ± temizle
                cell.className = 'cell';

                // Kalbur modunda
                if (gameState.sieveMode && gameState.sieveSteps[num]) {
                    const color = gameState.sieveSteps[num];
                    if (color === 'yellow') {
                        cell.classList.add('sieve-yellow');
                    } else if (color === 'blue') {
                        cell.classList.add('sieve-blue');
                    } else if (color === 'purple') {
                        cell.classList.add('sieve-purple');
                    } else if (color === 'red') {
                        cell.classList.add('sieve-red');
                    } else if (color === 'prime') {
                        cell.classList.add('sieve-prime');
                    }
                }
                // Normal modda
                else {
                    // YenmiÅŸ sayÄ±lar - artÄ±k asal mÄ± bileÅŸik mi belli olacak
                    if (gameState.eaten.includes(num)) {
                        cell.classList.add('eaten');
                        // Yendikten sonra ne olduÄŸu belli olsun
                        if (gameState.primes.includes(num)) {
                            cell.classList.add('revealed-prime');
                        } else if (num > 1) {
                            cell.classList.add('revealed-composite');
                        }
                    }
                    // HenÃ¼z yenmemiÅŸ sayÄ±lar - hepsi aynÄ± gÃ¶rÃ¼necek
                    else if (num > 1) {
                        // TÃ¼m sayÄ±lar aynÄ± gÃ¶rÃ¼nÃ¼yor, asal mÄ± deÄŸil mi belli deÄŸil!
                        cell.className = 'cell';
                    }

                    // Pac-Man pozisyonu
                    if (num === gameState.pacmanPos) {
                        cell.classList.add('pacman');
                        cell.textContent = 'ğŸ˜‹';
                    }
                    // Hayalet pozisyonu
                    else if (num === gameState.ghostPos && gameState.ghostsEnabled) {
                        cell.classList.add('ghost');
                        cell.textContent = 'ğŸ‘»';
                    }
                    // Normal sayÄ± gÃ¶sterimi
                    else if (!gameState.eaten.includes(num)) {
                        cell.textContent = num;
                    }
                }
            });

            updateStats();

            // Kalbur modunda tamamlanma kontrolÃ¼
            if (gameState.sieveMode) {
                checkSieveComplete();
            }
        }

        function updateStats() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('lives').textContent = 'â¤ï¸'.repeat(gameState.lives);
            document.getElementById('hints').textContent = gameState.hintCount;

            const remainingPrimes = gameState.primes.filter(p => !gameState.eaten.includes(p));
            document.getElementById('remaining').textContent = remainingPrimes.length;

            // Seviye tamamlandÄ± mÄ±?
            if (remainingPrimes.length === 0 && gameState.gameActive) {
                levelComplete();
            }
        }

        function startGame() {
            gameState = {
                score: 0,
                level: 1,
                lives: 3,
                pacmanPos: 1,
                ghostPos: null,
                ghostsEnabled: gameState.ghostsEnabled || false,
                primes: sieveOfEratosthenes(100),
                eaten: [],
                maxNum: 100,
                gameActive: true,
                hintUsed: false,
                hintCount: 0,
                sieveMode: false,
                sieveSteps: {},
                sieveMultiples: {
                    2: 'yellow',
                    3: 'blue',
                    5: 'purple',
                    7: 'red'
                },
                shuffleMode: gameState.shuffleMode || false,
                numberOrder: []
            };

            initBoard();

            if (gameState.shuffleMode) {
                showMessage('ğŸ² Oyun karÄ±ÅŸÄ±k modda baÅŸladÄ±! SayÄ±larÄ± bul!', 'info');
            } else {
                showMessage('Oyun baÅŸladÄ±! Asal sayÄ±larÄ± topla!', 'info');
            }

            if (gameState.ghostsEnabled) {
                placeGhost();
            }
        }

        function movePackman(targetNum) {
            if (!gameState.gameActive) {
                showMessage('Ã–nce yeni oyun baÅŸlat!', 'error');
                return;
            }

            // Hareket edilebilir mi kontrol et
            if (gameState.eaten.includes(targetNum)) {
                showMessage('Bu sayÄ± zaten yendi!', 'error');
                return;
            }

            // Pac-Man'i hareket ettir
            gameState.pacmanPos = targetNum;

            // SayÄ±yÄ± ye
            eatNumber(targetNum);

            // Hayalet hareketi
            if (gameState.ghostsEnabled && gameState.ghostPos) {
                moveGhost();
            }

            updateBoard();
        }

        function eatNumber(num) {
            if (gameState.eaten.includes(num)) return;

            gameState.eaten.push(num);

            if (gameState.primes.includes(num)) {
                // Asal sayÄ± yendi - puan hesapla
                let points = 10;
                let bonusPoints = 0;

                // Ä°pucu kullanÄ±ldÄ±ysa puan dÃ¼ÅŸÃ¼r
                if (gameState.hintUsed) {
                    points = 5;  // YarÄ± puan
                    showMessage(`âœ… ${num} asal sayÄ±! Ä°pucu kullandÄ±ÄŸÄ±n iÃ§in +5 puan ğŸ’¡`, 'success');
                } else {
                    showMessage(`Harika! ${num} asal sayÄ±! +10 puan ğŸ‰`, 'success');
                }

                gameState.score += points;

                // Bonus puan (bÃ¼yÃ¼k asallar iÃ§in)
                if (num > 50 && !gameState.hintUsed) {
                    bonusPoints = 5;
                    gameState.score += bonusPoints;
                    showMessage(`BÃ¼yÃ¼k asal bonus! +5 ekstra puan! ğŸŒŸ`, 'success');
                } else if (num > 50 && gameState.hintUsed) {
                    bonusPoints = 2;
                    gameState.score += bonusPoints;
                    showMessage(`BÃ¼yÃ¼k asal! Ä°pucu kullandÄ±ÄŸÄ±n iÃ§in +2 bonus ğŸ’¡`, 'success');
                }

                // Ä°pucu durumunu sÄ±fÄ±rla
                gameState.hintUsed = false;

            } else if (num > 1) {
                // BileÅŸik sayÄ± yendi - puan kaybet
                gameState.score -= 5;
                gameState.lives--;
                showMessage(`HayÄ±r! ${num} asal deÄŸil! -5 puan ve 1 can kaybettin! ğŸ˜¢`, 'error');

                // Ä°pucu durumunu sÄ±fÄ±rla
                gameState.hintUsed = false;

                if (gameState.lives <= 0) {
                    gameOver();
                }
            }
        }

        function placeGhost() {
            if (!gameState.ghostsEnabled) return;

            let availablePositions = [];
            for (let i = 2; i <= 100; i++) {
                if (!gameState.eaten.includes(i) && i !== gameState.pacmanPos) {
                    availablePositions.push(i);
                }
            }

            if (availablePositions.length > 0) {
                gameState.ghostPos = availablePositions[Math.floor(Math.random() * availablePositions.length)];
            }
        }

        function moveGhost() {
            if (!gameState.ghostsEnabled || !gameState.ghostPos) return;

            // Basit hayalet hareketi - Pac-Man'e doÄŸru
            let ghostRow = Math.floor((gameState.ghostPos - 1) / 10);
            let ghostCol = (gameState.ghostPos - 1) % 10;
            let pacRow = Math.floor((gameState.pacmanPos - 1) / 10);
            let pacCol = (gameState.pacmanPos - 1) % 10;

            let newRow = ghostRow;
            let newCol = ghostCol;

            // Rastgele hareket
            if (Math.random() < 0.5) {
                if (pacRow > ghostRow) newRow++;
                else if (pacRow < ghostRow) newRow--;
            } else {
                if (pacCol > ghostCol) newCol++;
                else if (pacCol < ghostCol) newCol--;
            }

            // SÄ±nÄ±rlarÄ± kontrol et
            newRow = Math.max(0, Math.min(9, newRow));
            newCol = Math.max(0, Math.min(9, newCol));

            let newPos = newRow * 10 + newCol + 1;

            if (!gameState.eaten.includes(newPos)) {
                gameState.ghostPos = newPos;

                // Pac-Man'i yakaladÄ± mÄ±?
                if (gameState.ghostPos === gameState.pacmanPos) {
                    gameState.lives--;
                    showMessage('Hayalet seni yakaladÄ±! 1 can kaybettin! ğŸ‘»', 'error');

                    if (gameState.lives <= 0) {
                        gameOver();
                    } else {
                        // Pac-Man'i baÅŸlangÄ±Ã§ pozisyonuna gÃ¶nder
                        gameState.pacmanPos = 1;
                        placeGhost();
                    }
                }
            }
        }

        function toggleGhosts() {
            gameState.ghostsEnabled = !gameState.ghostsEnabled;
            document.getElementById('ghostStatus').textContent = gameState.ghostsEnabled ? 'AÃ‡IK' : 'KAPALI';

            if (gameState.ghostsEnabled && gameState.gameActive) {
                placeGhost();
                showMessage('Hayaletler aktif! Dikkatli ol! ğŸ‘»', 'info');
            } else {
                gameState.ghostPos = null;
                showMessage('Hayaletler devre dÄ±ÅŸÄ±!', 'info');
            }

            updateBoard();
        }

        function toggleSieveMode() {
            if (!gameState.gameActive) {
                showMessage('Ã–nce oyunu baÅŸlat!', 'error');
                return;
            }

            gameState.sieveMode = !gameState.sieveMode;
            document.getElementById('sieveStatus').textContent = gameState.sieveMode ? 'AÃ‡IK' : 'KAPALI';

            if (gameState.sieveMode) {
                gameState.sieveSteps = {}; // Kalbur adÄ±mlarÄ±nÄ± sÄ±fÄ±rla
                showMessage('ğŸ”¢ Kalbur Modu Aktif! 2, 3, 5, 7\'ye tÄ±klayarak katlarÄ±nÄ± ele!', 'info');
                // Pac-Man'i gizle
                gameState.pacmanPos = null;
                gameState.ghostPos = null;
            } else {
                showMessage('ğŸ® Normal Mod\'a dÃ¶nÃ¼ldÃ¼!', 'info');
                gameState.pacmanPos = 1;
                if (gameState.ghostsEnabled) placeGhost();
            }

            updateBoard();
        }

        function toggleShuffle() {
            gameState.shuffleMode = !gameState.shuffleMode;
            document.getElementById('shuffleStatus').textContent = gameState.shuffleMode ? 'AÃ‡IK' : 'KAPALI';

            if (gameState.shuffleMode) {
                showMessage('ğŸ² SayÄ±lar karÄ±ÅŸtÄ±rÄ±lacak! Yeni oyun baÅŸlat!', 'info');
            } else {
                showMessage('ğŸ“Š SayÄ±lar sÄ±ralÄ± olacak!', 'info');
            }
        }

        function showSieveInstructions() {
            const message = `
                ğŸ”¢ KALBUR MODU TALÄ°MATLARI:
                1ï¸âƒ£ Ã–nce 1'i ele (asal deÄŸil)
                2ï¸âƒ£ 2'ye tÄ±kla â†’ TÃ¼m Ã§ift sayÄ±lar sarÄ± olur
                3ï¸âƒ£ 3'e tÄ±kla â†’ 3'Ã¼n katlarÄ± mavi olur
                4ï¸âƒ£ 5'e tÄ±kla â†’ 5'in katlarÄ± mor olur
                5ï¸âƒ£ 7'ye tÄ±kla â†’ 7'nin katlarÄ± kÄ±rmÄ±zÄ± olur
                âœ… Kalan sayÄ±lar (yeÅŸil) asal sayÄ±lardÄ±r!
                
                ğŸ’¡ Kalbur kullanÄ±mÄ±: DÃ¼ÅŸÃ¼k puan (toplam 50-100 puan)
                ğŸ§  Ezberleyerek: YÃ¼ksek puan (200+ puan)
            `;
            alert(message);
        }

        function showHint() {
            if (!gameState.gameActive) {
                showMessage('Ã–nce oyunu baÅŸlat!', 'error');
                return;
            }

            const remainingPrimes = gameState.primes.filter(p => !gameState.eaten.includes(p));

            if (remainingPrimes.length === 0) {
                showMessage('TÃ¼m asal sayÄ±lar toplandÄ±!', 'success');
                return;
            }

            // Ä°pucu kullanÄ±mÄ±nÄ± iÅŸaretle
            gameState.hintUsed = true;
            gameState.hintCount++;

            // Ä°pucu tÃ¼rÃ¼nÃ¼ rastgele seÃ§
            const hintType = Math.random();

            if (hintType < 0.3) {
                // Eratosthenes ipucu
                const hints = [
                    'ğŸ’¡ 2\'nin katlarÄ± asal olamaz (4,6,8...)',
                    'ğŸ’¡ 3\'Ã¼n katlarÄ± asal olamaz (6,9,12...)',
                    'ğŸ’¡ 5\'in katlarÄ± asal olamaz (10,15,20...)',
                    'ğŸ’¡ Ã‡ift sayÄ±lar asal olamaz (2 hariÃ§)',
                    'ğŸ’¡ 1 asal sayÄ± deÄŸildir!',
                    'ğŸ’¡ 2 en kÃ¼Ã§Ã¼k asal sayÄ±dÄ±r ve tek Ã§ift asaldÄ±r',
                    'ğŸ’¡ 7\'nin katlarÄ± asal olamaz (14,21,28...)',
                    'ğŸ’¡ 11\'in katlarÄ± asal olamaz (22,33,44...)'
                ];
                showMessage(hints[Math.floor(Math.random() * hints.length)] + ' (Sonraki asal: yarÄ± puan)', 'info');
            } else if (hintType < 0.6) {
                // BÃ¶lge ipucu
                const minPrime = Math.min(...remainingPrimes);
                if (minPrime < 30) {
                    showMessage('ğŸ’¡ 30\'dan kÃ¼Ã§Ã¼k asal sayÄ±lar var! (Sonraki asal: yarÄ± puan)', 'info');
                } else if (minPrime < 50) {
                    showMessage('ğŸ’¡ 30-50 arasÄ±nda asal sayÄ±lar var! (Sonraki asal: yarÄ± puan)', 'info');
                } else if (minPrime < 70) {
                    showMessage('ğŸ’¡ 50-70 arasÄ±nda asal sayÄ±lar var! (Sonraki asal: yarÄ± puan)', 'info');
                } else {
                    showMessage('ğŸ’¡ 70\'ten bÃ¼yÃ¼k asal sayÄ±lar var! (Sonraki asal: yarÄ± puan)', 'info');
                }
            } else {
                // YakÄ±nlÄ±k ipucu
                let closestPrime = remainingPrimes.reduce((prev, curr) => {
                    return Math.abs(curr - gameState.pacmanPos) < Math.abs(prev - gameState.pacmanPos) ? curr : prev;
                });

                const distance = Math.abs(closestPrime - gameState.pacmanPos);
                if (distance <= 3) {
                    showMessage('ğŸ”¥ Ã‡ok yakÄ±ndasÄ±n! 3 sayÄ± iÃ§inde asal var! (Sonraki asal: yarÄ± puan)', 'info');
                } else if (distance <= 10) {
                    showMessage('ğŸŒ¡ï¸ IsÄ±nÄ±yorsun! 10 sayÄ± iÃ§inde asal var! (Sonraki asal: yarÄ± puan)', 'info');
                } else {
                    showMessage('â„ï¸ SoÄŸuk! Asal sayÄ±lar uzakta! (Sonraki asal: yarÄ± puan)', 'info');
                }
            }

            // Ä°pucu sayÄ±sÄ±nÄ± gÃ¶ster
            updateStats();
        }

        function levelComplete() {
            gameState.level++;
            let levelBonus = 50;

            // Ä°pucu kullanÄ±mÄ±na gÃ¶re bonus ayarla
            if (gameState.hintCount === 0) {
                levelBonus = 100;  // Ä°pucu kullanmadan bitirdi
                showMessage(`ğŸ† MÃ¼kemmel! HiÃ§ ipucu kullanmadan bitirdin! +100 bonus puan! ğŸ†`, 'success');
            } else if (gameState.hintCount <= 3) {
                levelBonus = 75;
                showMessage(`ğŸ‰ Harika! Sadece ${gameState.hintCount} ipucu kullandÄ±n! +75 bonus puan! ğŸ‰`, 'success');
            } else if (gameState.hintCount <= 5) {
                levelBonus = 50;
                showMessage(`ğŸ‰ Seviye ${gameState.level - 1} tamamlandÄ±! +50 bonus puan! ğŸ‰`, 'success');
            } else {
                levelBonus = 25;
                showMessage(`âœ… Seviye tamamlandÄ±! Ã‡ok ipucu kullandÄ±n (${gameState.hintCount}). +25 puan`, 'success');
            }

            gameState.score += levelBonus;

            setTimeout(() => {
                // Yeni seviye baÅŸlat
                gameState.eaten = [];
                gameState.pacmanPos = 1;
                gameState.lives = Math.min(5, gameState.lives + 1); // Ekstra can
                gameState.hintUsed = false;
                gameState.hintCount = 0;  // Ä°pucu sayÄ±sÄ±nÄ± sÄ±fÄ±rla

                if (gameState.ghostsEnabled) {
                    placeGhost();
                }

                initBoard();
                showMessage(`Seviye ${gameState.level} baÅŸladÄ±! Daha hÄ±zlÄ± ol!`, 'info');
            }, 2000);
        }

        function gameOver() {
            gameState.gameActive = false;

            let performanceMsg = '';
            if (gameState.hintCount === 0) {
                performanceMsg = ' HiÃ§ ipucu kullanmadÄ±n! ğŸ†';
            } else if (gameState.hintCount <= 5) {
                performanceMsg = ` ${gameState.hintCount} ipucu kullandÄ±n.`;
            } else {
                performanceMsg = ` Ã‡ok fazla ipucu kullandÄ±n (${gameState.hintCount}). Daha az ipucuyla dene!`;
            }

            showMessage(`ğŸ˜¢ Oyun Bitti! Final PuanÄ±: ${gameState.score}${performanceMsg} ğŸ˜¢`, 'error');

            // YÃ¼ksek skor kontrolÃ¼
            const highScore = localStorage.getItem('asalPacmanHighScore') || 0;
            if (gameState.score > highScore) {
                localStorage.setItem('asalPacmanHighScore', gameState.score);
                setTimeout(() => {
                    showMessage(`ğŸ† YENÄ° REKOR: ${gameState.score} puan! ğŸ†`, 'success');
                }, 1000);
            }
        }

        function showMessage(text, type) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.className = `message ${type}`;

            // MesajÄ± otomatik gizle
            setTimeout(() => {
                if (messageEl.textContent === text) {
                    messageEl.textContent = '';
                    messageEl.className = 'message info';
                }
            }, 3000);
        }

        // Sayfa yÃ¼klendiÄŸinde oyunu baÅŸlat
        document.addEventListener('DOMContentLoaded', () => {
            initBoard();

            // YÃ¼ksek skoru gÃ¶ster
            const highScore = localStorage.getItem('asalPacmanHighScore') || 0;
            if (highScore > 0) {
                showMessage(`En yÃ¼ksek skor: ${highScore}`, 'info');
            }
        });

        // Klavye kontrolleri
        document.addEventListener('keydown', (e) => {
            if (!gameState.gameActive) return;

            let newPos = gameState.pacmanPos;
            const row = Math.floor((gameState.pacmanPos - 1) / 10);
            const col = (gameState.pacmanPos - 1) % 10;

            switch (e.key) {
                case 'ArrowUp':
                    if (row > 0) newPos -= 10;
                    break;
                case 'ArrowDown':
                    if (row < 9) newPos += 10;
                    break;
                case 'ArrowLeft':
                    if (col > 0) newPos -= 1;
                    break;
                case 'ArrowRight':
                    if (col < 9) newPos += 1;
                    break;
                default:
                    return;
            }

            e.preventDefault();
            if (newPos !== gameState.pacmanPos) {
                movePackman(newPos);
            }
        });
    </script>
</body>

</html>